Refactor this based on config I (Ben Yanke) have already created
